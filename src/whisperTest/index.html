<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>Whisper.cpp ì‹¤ì‹œê°„ ìŒì„± ì¸ì‹</title>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      padding: 2em;
      max-width: 1200px;
      margin: 0 auto;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      color: white;
    }

    .container {
      background: rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(10px);
      border-radius: 20px;
      padding: 2em;
      box-shadow: 0 8px 32px rgba(31, 38, 135, 0.37);
      border: 1px solid rgba(255, 255, 255, 0.18);
    }

    h1 {
      text-align: center;
      margin-bottom: 2em;
      font-size: 2.5em;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
    }

    .section {
      margin-bottom: 2em;
      padding: 1.5em;
      background: rgba(255, 255, 255, 0.05);
      border-radius: 15px;
      border: 1px solid rgba(255, 255, 255, 0.1);
    }

    .section h2 {
      margin-top: 0;
      color: #fff;
      font-size: 1.5em;
    }

    select, button {
      padding: 12px 20px;
      border: none;
      border-radius: 10px;
      font-size: 16px;
      margin: 5px;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    select {
      background: rgba(255, 255, 255, 0.9);
      color: #333;
      min-width: 300px;
    }

    button {
      background: linear-gradient(45deg, #FF6B6B, #4ECDC4);
      color: white;
      font-weight: bold;
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    button:hover:not(:disabled) {
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(0,0,0,0.2);
    }

    button:disabled {
      opacity: 0.5;
      cursor: not-allowed;
      transform: none;
    }

    #progress-container {
      margin-top: 1em;
      background: rgba(255, 255, 255, 0.1);
      padding: 1em;
      border-radius: 10px;
    }

    #progress-bar {
      width: 100%;
      height: 30px;
      border-radius: 15px;
      background: rgba(255, 255, 255, 0.2);
    }

    #progress-bar::-webkit-progress-bar {
      border-radius: 15px;
      background: rgba(255, 255, 255, 0.2);
    }

    #progress-bar::-webkit-progress-value {
      border-radius: 15px;
      background: linear-gradient(90deg, #4ECDC4, #44A08D);
    }

    .recording-controls {
      display: flex;
      gap: 1em;
      justify-content: center;
      align-items: center;
      flex-wrap: wrap;
    }

    .audio-level-container {
      margin: 1em 0;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 10px;
      height: 20px;
      overflow: hidden;
    }

    #audio-level {
      height: 100%;
      background: linear-gradient(90deg, #4ECDC4, #FF6B6B);
      width: 0%;
      transition: width 0.1s ease;
    }

    #transcription {
      background: rgba(0, 0, 0, 0.2);
      border-radius: 10px;
      padding: 1.5em;
      max-height: 400px;
      overflow-y: auto;
      font-family: 'Monaco', 'Menlo', monospace;
      font-size: 14px;
      line-height: 1.6;
    }

    .transcription-item {
      margin-bottom: 1em;
      padding: 10px;
      background: rgba(255, 255, 255, 0.05);
      border-radius: 8px;
      border-left: 4px solid #4ECDC4;
    }

    .transcription-item strong {
      color: #4ECDC4;
    }

    #status {
      font-weight: bold;
      padding: 10px;
      border-radius: 5px;
      background: rgba(255, 255, 255, 0.1);
      display: inline-block;
      margin-top: 10px;
    }

    .status-container {
      text-align: center;
    }

    @keyframes pulse {
      0% { opacity: 1; }
      50% { opacity: 0.5; }
      100% { opacity: 1; }
    }

    .recording {
      animation: pulse 2s infinite;
    }
  </style>
</head>
<body>
<div class="container">
  <h1>ğŸ¤ Whisper.cpp ì‹¤ì‹œê°„ ìŒì„± ì¸ì‹</h1>

  <div class="section" style="background: rgba(255, 255, 255, 0.1); padding: 1em; border-radius: 10px; margin-bottom: 1em;">
    <h3 style="margin-top: 0; color: #4ECDC4;">ğŸ”§ ì„¤ì¹˜ ë° ì‚¬ìš© ì•ˆë‚´</h3>
    <div style="font-size: 14px; line-height: 1.6;">
      <div style="background: rgba(0,0,0,0.2); padding: 1em; border-radius: 8px; margin-bottom: 1em;">
        <p style="margin: 0; color: #4ECDC4;"><strong>ğŸ“‹ whisper.cpp ë¹Œë“œ ë° ì‹¤í–‰ ë°©ë²•:</strong></p>
        <pre style="font-size: 12px; overflow-x: auto; margin: 0.5em 0; color: #ccc;">
# 1. whisper.cpp í´ë¡  ë° ë¹Œë“œ
git clone https://github.com/ggml-org/whisper.cpp
cd whisper.cpp
mkdir build-em && cd build-em
emcmake cmake ..
make -j

# 2. ì„œë²„ ì‹¤í–‰ (whisper.cpp/examples í´ë”ì—ì„œ)
python3 server.py

# 3. ë¸Œë¼ìš°ì €ì—ì„œ ì ‘ì†
# http://localhost:8000/whisper.cpp/</pre>
      </div>

      <p><strong>ğŸŒ ë¡œì»¬ ì„œë²„ ì—†ì´ ì‚¬ìš©:</strong></p>
      <ul style="margin: 0.5em 0; padding-left: 1.5em;">
        <li>CDNì—ì„œ ìë™ìœ¼ë¡œ WASM íŒŒì¼ì„ ë¡œë“œí•©ë‹ˆë‹¤</li>
        <li>ë„¤íŠ¸ì›Œí¬ ì—°ê²°ì´ í•„ìš”í•©ë‹ˆë‹¤</li>
        <li>ë¡œì»¬ ì„œë²„ë³´ë‹¤ ëŠë¦´ ìˆ˜ ìˆìŠµë‹ˆë‹¤</li>
      </ul>

      <p><strong>âš™ï¸ ì‹œìŠ¤í…œ ìš”êµ¬ì‚¬í•­:</strong></p>
      <ul style="margin: 0.5em 0; padding-left: 1.5em;">
        <li>WASM SIMD ì§€ì› ë¸Œë¼ìš°ì € (Chrome ê¶Œì¥)</li>
        <li>SharedArrayBuffer ì§€ì› (HTTPS ë˜ëŠ” localhost í•„ìš”)</li>
        <li>ìµœì†Œ 2GB RAM (small ëª¨ë¸ ì‚¬ìš© ì‹œ)</li>
      </ul>

      <p style="margin-bottom: 0;"><strong>ğŸ“Š ì§€ì› ëª¨ë¸:</strong> tiny (39MB), base (74MB), small (244MB) - ìµœëŒ€ 120ì´ˆ ì˜¤ë””ì˜¤</p>
    </div>
  </div>

  <div class="section">
    <h2>ğŸ“¥ ëª¨ë¸ ë‹¤ìš´ë¡œë“œ</h2>
    <div style="margin-bottom: 1em;">
      <label for="model-select">ëª¨ë¸ ì„ íƒ (í•œêµ­ì–´ ì§€ì›):</label><br>
      <select id="model-select"></select>
    </div>

    <button id="download-btn">ì„ íƒí•œ ëª¨ë¸ ë‹¤ìš´ë¡œë“œ</button>

    <div id="progress-container" style="display: none;">
      <p id="progress-text">ë‹¤ìš´ë¡œë“œ ì¤‘...</p>
      <progress id="progress-bar" value="0" max="100"></progress>
    </div>
  </div>

  <div class="section">
    <h2>ğŸ™ï¸ ìŒì„± ì¸ì‹</h2>
    <div class="recording-controls">
      <button id="start-recording" disabled>ğŸ”´ ë…¹ìŒ ì‹œì‘</button>
      <button id="stop-recording" disabled>â¹ï¸ ë…¹ìŒ ì¤‘ì§€</button>
    </div>

    <div class="audio-level-container">
      <div id="audio-level"></div>
    </div>

    <p style="text-align: center; font-size: 14px; opacity: 0.8;">
      ğŸ“Œ íŒ: ëª…í™•í•˜ê²Œ í•œêµ­ì–´ë¡œ ë§í•´ë³´ì„¸ìš”. ì‹¤ì‹œê°„ìœ¼ë¡œ í…ìŠ¤íŠ¸ê°€ ë‚˜íƒ€ë‚©ë‹ˆë‹¤.
    </p>
  </div>

  <div class="section">
    <h2>ğŸ“ ì¸ì‹ ê²°ê³¼</h2>
    <div id="transcription">
      <p style="text-align: center; opacity: 0.6;">ìŒì„± ì¸ì‹ ê²°ê³¼ê°€ ì—¬ê¸°ì— ì‹¤ì‹œê°„ìœ¼ë¡œ í‘œì‹œë©ë‹ˆë‹¤...</p>
    </div>
  </div>

  <div class="status-container">
    <p>ğŸ”¥ ìƒíƒœ: <span id="status">ëŒ€ê¸° ì¤‘</span></p>
  </div>
</div>

<script>
  // whisper.cpp WASM ëª¨ë“ˆ ì „ì—­ ì„¤ì •
  var Module = {
    onRuntimeInitialized: function() {
      console.log('Whisper WASM ëª¨ë“ˆì´ ì„±ê³µì ìœ¼ë¡œ ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤.');
      Module.ready = true;

      // ìƒíƒœ ì—…ë°ì´íŠ¸
      if (typeof statusElement !== 'undefined') {
        statusElement.textContent = 'WASM ëª¨ë“ˆ ì¤€ë¹„ ì™„ë£Œ. ëª¨ë¸ì„ ì„ íƒí•˜ê³  ë‹¤ìš´ë¡œë“œí•˜ì„¸ìš”.';
      }
    },

    print: function(text) {
      console.log('WASM ì¶œë ¥:', text);
    },

    printErr: function(text) {
      console.error('WASM ì˜¤ë¥˜:', text);
    },

    // íŒŒì¼ ì‹œìŠ¤í…œ ì„¤ì •
    preRun: [],
    postRun: [],

    // ë©”ëª¨ë¦¬ ì„¤ì • (whisper.cppëŠ” ë§ì€ ë©”ëª¨ë¦¬ê°€ í•„ìš”)
    INITIAL_MEMORY: 64 * 1024 * 1024, // 64MB

    // ì˜¤ë¥˜ ì²˜ë¦¬
    onAbort: function(what) {
      console.error('WASM ëª¨ë“ˆì´ ì¤‘ë‹¨ë˜ì—ˆìŠµë‹ˆë‹¤:', what);
      if (typeof statusElement !== 'undefined') {
        statusElement.textContent = 'WASM ëª¨ë“ˆ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.';
      }
    },

    // ì§„í–‰ë¥  í‘œì‹œ
    monitorRunDependencies: function(left) {
      if (left === 0) {
        console.log('ëª¨ë“  WASM ì¢…ì†ì„±ì´ ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤.');
      } else {
        console.log('WASM ì¢…ì†ì„± ë¡œë“œ ì¤‘:', left, 'ê°œ ë‚¨ìŒ');
      }
    }
  };

  // ë¸Œë¼ìš°ì € í˜¸í™˜ì„± ì²´í¬
  function checkBrowserCompatibility() {
    // WASM ì§€ì› í™•ì¸
    if (typeof WebAssembly === 'undefined') {
      alert('ì´ ë¸Œë¼ìš°ì €ëŠ” WebAssemblyë¥¼ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. Chrome, Firefox, Safariì˜ ìµœì‹  ë²„ì „ì„ ì‚¬ìš©í•˜ì„¸ìš”.');
      return false;
    }

    // WASM SIMD ì§€ì› í™•ì¸ (whisper.cpp í•„ìˆ˜)
    if (typeof WebAssembly.instantiate !== 'function') {
      console.warn('WASM SIMDê°€ ì§€ì›ë˜ì§€ ì•Šì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
    }

    return true;
  }

  // í˜ì´ì§€ ë¡œë“œ ì‹œ í˜¸í™˜ì„± ê²€ì‚¬
  document.addEventListener('DOMContentLoaded', function() {
    if (!checkBrowserCompatibility()) {
      document.body.innerHTML = '<h1>ë¸Œë¼ìš°ì € í˜¸í™˜ì„± ì˜¤ë¥˜</h1><p>WebAssemblyë¥¼ ì§€ì›í•˜ëŠ” ë¸Œë¼ìš°ì €ê°€ í•„ìš”í•©ë‹ˆë‹¤.</p>';
    }
  });
</script>

<script src="downloader.js"></script>
</body>
</html>